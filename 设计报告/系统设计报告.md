## 一、需求分析

### 1.1 需求描述

#### 1.1.1 总论

在过去的几十年中，随着计算机技术的不断进步和信息网络的覆盖面不断扩大，互联网已经成为人们获取信息、交流思想的重要工具。而在这个信息爆炸的时代，如何高效地获取、管理和共享信息成为一个亟待解决的问题。特别是对于北京航空航天大学这所以信息技术专业见长的高校的学生来说，互联网不仅仅是一个获取娱乐信息的途径，更应当是获取学习资源、交流和合作的有效平台。

目前，我校师生在进行资料分享时，仍然依赖传统的线下分享方式或是在微信、QQ等平台上线上分享的方式，这种方式不仅效率低下，而且面临着数据存储、维护和更新等方面的挑战。此外，传统的资料分享方式往往缺乏对学习过程的追踪和分析，也无法满足学生个性化的学习需求。在这种情况下，设计一个集成化、信息化的校园资料分享平台显得尤为重要。建设一个功能全面、操作简便的学习资料分享平台，不仅能有效弥补现有系统的不足，还能为学生和教师提供一个高效、灵活的学习环境，推动教育信息化的进一步发展。

因此，我们计划开发一个名为“**航U邦**”的**学习资料共享平台**，取北航学子互帮互助之意，旨在通过将互联网与现代信息技术相结合，依托全部师生均可以使用的北航云盘，提供一个高效、可靠且便捷的资料共享环境。学生可以通过该平台自由**下载学习资料、分享学习资料、解答悬赏任务、发布悬赏任务**。通过采用电子化存储和管理方式，平台不仅可以大幅度提高资料的查找、更新和维护效率，还能为学生提供实时的资料查询和任务反馈。除此之外，本平台创造性地开发了“**菜币**”虚拟货币系统，平台应用者可以使用菜币发布悬赏任务、购买收费资源，还可以通过分享高质量资源、解答他人任务等方式获取菜币。

#### 1.1.2 管理员相关功能

* 管理公告：查看公告、发布公告、修改公共、删除公告。
* 管理用户：查看用户、封禁用户、解封用户。
* 管理分享：搜索分享资源、查看分享资源、删除分享资源。
* 管理悬赏：搜索悬赏任务、查看悬赏任务、删除悬赏任务。

#### 1.1.3 用户个人信息相关功能

* 查看公告：用户可以看到管理员发布的公告。
* 修改个人基本信息：修改密码、修改电子邮件地址、修改个性标签、修改头像。
* 查看个人数据：查看菜币数量、查看获赞数量、查看发帖次数、查看回答次数、查看粉丝数量。
* 关注/取消关注其他用户。
* 收藏/取消收藏其他用户。
* 退出登录。
* 打开/关闭黑暗模式，打开/关闭背景颗粒。

#### 1.1.4 共享资源相关功能

* 对资源进行筛选：可以依据是否收费、标签（tags）对共享资源进行筛选。
* 对资源进行排序：可以选择 最推荐、最多点赞、最多收藏、最近创建、最近评论 对共享资源进行排序。
* 对资源进行搜索：平台支持依据关键词对资源进行模糊搜索。
* 购买付费资源。
* 查看资源：查看资源点赞数量、收藏数量、评论数量、点踩数量；查看资源介绍以及标签。
* 查看某资源的评论。
* 下载资源：用户可以通过北航云盘下载免费资源或者已经购买了的资源。
* 获取自己分享的所有资源。
* 编辑自己分享的资源。
* 删除自己分享的资源。
* 分享新资源：用户可以自由地分享资源，并设定标题、收费金额、标签、描述等关键信息。

#### 1.1.5 任务悬赏相关功能

* 对悬赏进行筛选：可以依据标签（tags）对任务悬赏进行筛选。
* 对悬赏进行排序：可以选择 最推荐、悬赏金额、最近创建、最近回答 对任务悬赏进行筛选。
* 对悬赏进行搜索：平台支持依据关键词对悬赏进行模糊搜索。
* 查看悬赏内容：查看悬赏的题目、状态（一般为进行中）、标签、发布时间、悬赏需求。
* 解答悬赏任务：对某个特定的悬赏上传特定的资源。
* 获取自己发布的所有悬赏任务。
* 发布新悬赏：用户可以发布新的悬赏任务，并设定标题、报酬、标签、悬赏需求等关键信息。
* 下载解答者提供的资源：某悬赏的发布者可以下载解答者上传的资源，其他用户则无法看到该资源。
* 关闭悬赏：某悬赏的发布者可以选择某一个解答者上传的资源作为最佳答案，并将报酬支付给该解答者，以关闭该悬赏。

### 1.2 数据流图

### 1.3 数据元素表



---

## 二、数据库概念模式设计

### 系统初步E-R图

![系统初步 E-R 图](images/系统初步E-R图.png)

### 系统基本E-R图

分析系统初步 E-R 图，我们发现可以消除以下冗余数据：

- 消息中的内容可以通过关联的实体导出，因此不必作为一个单独的属性
- 共享帖里的收藏数、点赞数、打赏数、点踩数可以通过操作记录得出

我们的初步 E-R 图里没有冗余联系，因此得到基本 E-R 图如下，共**九**个实体：

![系统基本 E-R 图](images/系统基本E-R图.png)

---

## 三、数据库逻辑模式设计与优化

### 3.1 数据库关系模式定义

#### 3.1.1 实体

1. 用户(<u>id</u>, 身份, 名称, 菜币余额, 头像, 个性签名, 邮箱, 密码);

2. 共享资源(<u>id</u>, 标题, 价格, 内容, 创建时间, 简介, 资源路径);
3. 评论(<u>id</u>, 类型, 创建时间, 内容);

3. 悬赏任务(<u>id</u>, 标题, 悬赏金额, 内容, 创建时间, 简介);
4. 答案(<u>id</u>, 内容, 资源路径, 创建时间);

4. 公告(<u>id</u>, 创建时间, 内容)；

5. 消息(<u>id</u>, 类型, 状态);

8. 操作记录(<u>id</u>, 菜币变化值, 类型);

9. 标签(<u>id</u>, 名称);

#### 3.1.2 联系

1. 用户-共享资源(<u>用户id</u>, <u>共享资源id</u>);
2. 用户-悬赏任务(<u>用户id</u>, <u>悬赏任务id</u>);
3. 用户-用户(<u>用户id1</u>, 用户id2, 关注时间);
4. 操作记录-用户(<u>操作记录id</u>, 用户id);
5. 评论-用户(<u>评论id</u>, 用户);
6. 回答-用户(<u>回答id</u>, 用户);
7. 用户-消息(<u>消息id</u>, 用户id)
8. 公告-消息(<u>消息id</u>, 公告id);
9. 共享资源-消息(<u>消息id</u>, 共享资源id);
10. 悬赏任务-消息(<u>消息id</u>, 悬赏任务id);
11. 回答-悬赏任务(<u>回答id</u>, 悬赏任务id);
12. 评论-评论(<u>评论id1</u>, 评论id2);
13. 评论-共享资源(<u>评论id</u>, 共享资源id);
14. 操作记录-共享资源(<u>操作记录id</u>, 共享资源id);
15. 标签-共享资源(<u>标签id</u>, 共享资源id);
16. 标签-悬赏任务(<u>标签id</u>, 悬赏任务id)；

### 3.2 关系模式范式等级的判定与规范化

接下来我们遵循下图中的原则对关系模式的范式等级进行判定：

![范式判断原则](./images/范式判断原则.png)

#### 3.2.1 实体

1. 用户(<u>id</u>, 身份, 名称, 菜币余额, 头像, 个性签名, 邮箱, 密码);

   id为用户的主键，其他属性均依赖于id，邮箱可以为空，不可以决定id，名称可以决定id，为另一个候选码，但不存在部分依赖。因此该关系为3NF。又因为所有的函数依赖左侧都有码，因此是**BCNF**的。

2. 共享资源(<u>id</u>, 标题, 价格, 内容, 创建时间, 简介, 资源路径);

   id为共享资源的主键，无其他候选码，并且所有的函数依赖左侧都有id，因此是**BCNF**的。

3. 评论(<u>id</u>, 类型, 创建时间, 内容);

   id为评论的主键，无其他候选码，并且所有的函数依赖左侧都有id，因此是**BCNF**的。

3. 悬赏任务(<u>id</u>, 标题, 悬赏金额, 内容, 创建时间, 简介);

   id为悬赏任务的主键，无其他候选码，并且所有的函数依赖左侧都有id，因此是**BCNF**的。

4. 答案(<u>id</u>, 内容, 资源路径, 创建时间);

   id为内容的主键，无其他候选码，并且所有的函数依赖左侧都有id，因此是**BCNF**的。

4. 公告(<u>id</u>, 创建时间, 内容)；

   id为公告的主键，无其他候选码，并且所有的函数依赖左侧都有id，因此是**BCNF**的。

5. 消息(<u>id</u>, 类型, 状态);

   id为消息的主键，无其他候选码，并且所有的函数依赖左侧都有id，因此是**BCNF**的。

8. 操作记录(<u>id</u>, 菜币变化值, 类型);

   id为操作记录的主键，无其他候选码，并且所有的函数依赖左侧都有id，因此是**BCNF**的。

9. 标签(<u>id</u>, 名称);

   id为标签的主键，无其他候选码，并且唯一的非主属性名称完全函数依赖于id，因此是**BCNF**的。

#### 3.2.2 联系

1. 用户-共享资源(<u>用户id</u>, <u>共享资源id</u>);

   由于二者共同组成唯一的候选码并且不存在任何其他属性，因此为**BCNF**的。 

2. 用户-悬赏任务(<u>用户id</u>, <u>悬赏任务id</u>);

   由于二者共同组成唯一的候选码并且不存在任何其他属性，因此为**BCNF**的。 

3. 用户-用户(<u>用户id1</u>, 用户id2, 关注时间);

   该联系表示用户2关注用户1，非主属性均完全函数依赖于唯一的候选码id1，因此为**BCNF**的。

4. 其他联系

   对于其他联系，均是有且仅有两个属性，其中一个属性为主码，决定另一个属性。因此其他联系均是符合**BCNF**的。


### 关系模式范式等级的判定与规范化

### 数据库关系模式优化



---

## 四、数据库物理设计



---
